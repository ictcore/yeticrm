
Vtiger_List_Js("Rss_List_Js",{},{getDocumentHeight:function(){return jQuery(document).height()},registerRssButtonClickEvent:function(a){var b=this;a.on("click",".rssAddButton",function(c){b.showRssModal("getRssAddForm").then(function(e){var d=function(g){var h=app.validationEngineOptions;var f=g.find("#rssAddForm");h.onValidationComplete=function(j,i){if(i){b.rssFeedSave(j)}return false};f.validationEngine(h)};app.showModalWindow(e,d)})});a.on("click",".changeFeedSource",function(c){b.showRssModal("getRssWidget").then(function(e){var d=function(f){f.on("click",".rssLink",function(h){var g=jQuery(h.currentTarget);var i=g.data("id");b.getRssFeeds(i).then(function(){app.hideModalWindow()})})};app.showModalWindow(e,d)})})},breadCrumbsFilter:function(a){return},showRssModal:function(e){var c=this;var a=jQuery.Deferred();var d=jQuery.progressIndicator({});var b={module:app.getModuleName(),view:"ViewTypes",mode:e};AppConnector.request(b).then(function(f){d.progressIndicator({mode:"hide"});a.resolve(f)},function(g,f){});return a.promise()},rssFeedSave:function(b){var a=this;var c=b.serializeFormData();var d=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var e={module:app.getModuleName(),action:"Save",feedurl:c.feedurl};AppConnector.request(e).then(function(f){d.progressIndicator({mode:"hide"});if(f.result.success){app.hideModalWindow();a.getRssFeeds(f.result.id)}else{var g={title:app.vtranslate("JS_MESSAGE"),text:app.vtranslate(f.result.message),animation:"show"};Vtiger_Helper_Js.showPnotify(g)}})},getRssFeeds:function(f){var c=this;var b=jQuery.Deferred();var a=c.getListViewContainer();var d=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var e={module:app.getModuleName(),view:"List",id:f};AppConnector.requestPjax(e).then(function(g){b.resolve(g);a.find("#listViewContents").html(g);c.setFeedContainerHeight(a);d.progressIndicator({mode:"hide"})});return b.promise()},setFeedContainerHeight:function(b){var a=this.getDocumentHeight()/1.5;b.find(".feedListContainer").height(a)},registerFeedClickEvent:function(a){var b=this;a.on("click",".feedLink",function(f){var d=jQuery(f.currentTarget);var c=d.data("url");var g=b.getFrameElement(c);a.find(".feedFrame").html(g)})},getFrameElement:function(a){var b=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var c=jQuery("<iframe>",{id:"feedFrame",scrolling:"auto",width:"100%",height:this.getDocumentHeight()/2});c.addClass("table-bordered");this.getHtml(a).then(function(d){b.progressIndicator({mode:"hide"});var e=c[0].contentDocument;e.open();e.write(d);e.close()});return c},getHtml:function(b){var a=jQuery.Deferred();var c={module:app.getModuleName(),action:"GetHtml",url:b};AppConnector.request(c).then(function(d){a.resolve(d.result.html)});return a.promise()},registerDeleteRecordClickEvent:function(){var a=this.getListViewContainer();var b=this;a.on("click","#deleteButton",function(c){b.deleteRecord(a)})},deleteRecord:function(a){var d=this;var b=a.find("#recordId").val();var c=app.vtranslate("LBL_DELETE_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:c}).then(function(i){var g=app.getModuleName();var f={module:g,action:"DeleteAjax",record:b};var j=app.vtranslate("JS_RECORD_GETTING_DELETED");var h=jQuery.progressIndicator({message:j,position:"html",blockInfo:{enabled:true}});AppConnector.request(f).then(function(e){h.progressIndicator({mode:"hide"});if(e.success){d.getRssFeeds()}else{var k={text:app.vtranslate(e.error.message),title:app.vtranslate("JS_LBL_PERMISSION")};Vtiger_Helper_Js.showPnotify(k)}},function(e,k){})},function(e,f){})},registerMakeDefaultClickEvent:function(a){var b=this;a.on("click","#makeDefaultButton",function(){b.makeDefault(a)})},makeDefault:function(b){var e=Vtiger_List_Js.getInstance();var d=b.find("#recordId").val();var c=app.getModuleName();var a={module:c,action:"MakeDefaultAjax",record:d};var f=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(a).then(function(g){f.progressIndicator({mode:"hide"});if(g.success){var h={title:app.vtranslate("JS_MESSAGE"),text:app.vtranslate(g.result.message),animation:"show",type:"info"};Vtiger_Helper_Js.showPnotify(h)}else{Vtiger_Helper_Js.showPnotify({text:app.vtranslate(g.error.message),title:app.vtranslate("JS_LBL_PERMISSION")})}})},registerEvents:function(){this._super();var a=this.getListViewContainer();this.registerRssButtonClickEvent(a);this.registerFeedClickEvent(a);this.registerMakeDefaultClickEvent(a);this.setFeedContainerHeight(a)}});
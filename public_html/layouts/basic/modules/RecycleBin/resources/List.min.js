
Vtiger_List_Js("RecycleBin_List_Js",{emptyRecycleBin:function(a){var b=app.vtranslate("JS_MSG_EMPTY_RB_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:b}).then(function(f){var d=a+"&mode=emptyRecycleBin";var c=new RecycleBin_List_Js();AppConnector.request(d).then(function(e){if(e){jQuery(".clearRecycleBin").attr("disabled","disabled");c.recycleBinActionPostOperations(e)}})},function(c,d){})},deleteRecords:function(d){var f=Vtiger_List_Js.getInstance();var c=f.checkListRecordSelected();if(c!=true){var b=f.readSelectedIds(true);var a=f.getCurrentCvId();var e=app.vtranslate("LBL_MASS_DELETE_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:e}).then(function(j){var g=jQuery("#customFilter").val();var i=d+"&viewname="+a+"&selected_ids="+b+"&mode=deleteRecords&sourceModule="+g;var k=app.vtranslate("JS_RECORDS_ARE_GETTING_DELETED");var h=jQuery.progressIndicator({message:k,position:"html",blockInfo:{enabled:true}});AppConnector.request(i).then(function(m){if(m){h.progressIndicator({mode:"hide"});var l=new RecycleBin_List_Js();l.recycleBinActionPostOperations(m)}})},function(g,h){})}else{f.noRecordSelectedAlert()}},restoreRecords:function(d){var f=Vtiger_List_Js.getInstance();var c=f.checkListRecordSelected();if(c!=true){var b=f.readSelectedIds(true);var g=f.readExcludedIds(true);var a=f.getCurrentCvId();var e=app.vtranslate("JS_LBL_RESTORE_RECORDS_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:e}).then(function(l){var h=jQuery("#customFilter").val();var k=d+"&viewname="+a+"&selected_ids="+b+"&excluded_ids="+g+"&mode=restoreRecords&sourceModule="+h;var i=app.vtranslate("JS_RESTORING_RECORDS");var j=jQuery.progressIndicator({message:i,position:"html",blockInfo:{enabled:true}});AppConnector.request(k).then(function(n){if(n){j.progressIndicator({mode:"hide"});var m=new RecycleBin_List_Js();m.recycleBinActionPostOperations(n)}})},function(h,i){})}else{f.noRecordSelectedAlert()}},convertToJsonString:function(b){var a=[];a.push(b);return JSON.stringify(a)},deleteRecord:function(c){c=RecycleBin_List_Js.convertToJsonString(c);var e=Vtiger_List_Js.getInstance();var d=app.vtranslate("LBL_DELETE_CONFIRMATION");var a=jQuery("#customFilter").val();var b=e.getCurrentCvId();Vtiger_Helper_Js.showConfirmationBox({message:d}).then(function(i){var g=app.getModuleName();var f={module:g,viewname:b,selected_ids:c,action:"RecycleBinAjax",sourceModule:a,mode:"deleteRecords"};var j=app.vtranslate("JS_RECORD_GETTING_DELETED");var h=jQuery.progressIndicator({message:j,position:"html",blockInfo:{enabled:true}});AppConnector.request(f).then(function(l){if(l){h.progressIndicator({mode:"hide"});var k=new RecycleBin_List_Js();k.recycleBinActionPostOperations(l)}})},function(f,g){})},restoreRecord:function(c){c=RecycleBin_List_Js.convertToJsonString(c);var e=Vtiger_List_Js.getInstance();var a=jQuery("#customFilter").val();var b=e.getCurrentCvId();var d=app.vtranslate("JS_LBL_RESTORE_RECORD_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:d}).then(function(j){var h=app.getModuleName();var g={module:h,action:"RecycleBinAjax",viewname:b,selected_ids:c,mode:"restoreRecords",sourceModule:a};var f=app.vtranslate("JS_RESTORING_RECORD");var i=jQuery.progressIndicator({message:f,position:"html",blockInfo:{enabled:true}});AppConnector.request(g).then(function(l){if(l){i.progressIndicator({mode:"hide"});var k=new RecycleBin_List_Js();k.recycleBinActionPostOperations(l)}})},function(f,g){})}},{ListViewPostOperation:function(){if(parseInt(jQuery("#deletedRecordsTotalCount").val())==0){jQuery(".clearRecycleBin").attr("disabled","disabled")}else{jQuery(".clearRecycleBin").removeAttr("disabled")}},getDefaultParams:function(){var a=jQuery("#pageNumber").val();var c=app.getModuleName();var e=app.getParentModuleName();var b=this.getCurrentCvId();var g=jQuery("#orderBy").val();var d=jQuery("#sortOrder").val();var f={module:c,parent:e,page:a,view:"List",orderby:g,sortorder:d,sourceModule:jQuery("#customFilter").val()};return f},recycleBinActionPostOperations:function(d){jQuery("#recordsCount").val("");jQuery("#totalPageCount").text("");var c=this;var a=this.getCurrentCvId();if(d.success){var b=app.getModuleName();var e=c.getDefaultParams();AppConnector.request(e).then(function(f){app.hideModalWindow();var g=c.getListViewContentContainer();g.html(f);jQuery("#deSelectAllMsg").trigger("click");c.ListViewPostOperation();c.calculatePages().then(function(){c.updatePagination()})})}else{app.hideModalWindow();Vtiger_Helper_Js.showPnotify({title:app.vtranslate("JS_LBL_PERMISSION"),text:d.error.message})}},getRecordsCount:function(){var c=jQuery.Deferred();var e=jQuery("#recordsCount").val();if(e!=""){c.resolve(e)}else{var f="";var d=app.getModuleName();var a=jQuery("#customFilter").val();var b={module:d,sourceModule:a,view:"ListAjax",mode:"getRecordsCount"};AppConnector.request(b).then(function(h){var g=JSON.parse(h);jQuery("#recordsCount").val(g.result["count"]);f=g.result["count"];c.resolve(f)},function(g,h){})}return c.promise()},getPageJumpParams:function(){var c=app.getModuleName();var b=this.getCurrentCvId();var a={module:c,view:"ListAjax",mode:"getPageCount",sourceModule:jQuery("#sourceModule").val()};return a},registerDeleteRecordClickEvent:function(){var b=this;var a=this.getListViewContentContainer();a.on("click",".deleteRecordButton",function(f){var d=jQuery(f.currentTarget);var c=d.closest("tr").data("id");RecycleBin_List_Js.deleteRecord(c);f.stopPropagation()})},registerRestoreRecordClickEvent:function(){var b=this;var a=this.getListViewContentContainer();a.on("click",".restoreRecordButton",function(f){var d=jQuery(f.currentTarget);var c=d.closest("tr").data("id");RecycleBin_List_Js.restoreRecord(c);f.stopPropagation()})},registerEvents:function(){this._super();this.registerRestoreRecordClickEvent()}});
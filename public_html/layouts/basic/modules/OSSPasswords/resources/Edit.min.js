
Vtiger_Edit_Js("OSSPasswords_Edit_Js",{},{registerRecordPreSaveEvent:function(b){var a=this;if(typeof b=="undefined"){b=this.getForm()}b.on(Vtiger_Edit_Js.recordPreSave,function(f,d){var c=b.find('[name="password"]').val();var h=b.find('[name="record"]').val();var g={};if(c=="**********"){g={};g.data={module:"OSSPasswords",action:"GetPass",record:h};g.async=false;AppConnector.request(g).done(function(j){var e=j.result;if(e.success){var i=document.getElementById("OSSPasswords_editView_fieldName_password");i.value=e.password;i.onchange()}},function(i,e){});passwordStrength("","")}c=b.find('[name="password"]').val();g={};g.data={module:"OSSPasswords",action:"CheckPass",password:c,id:h};g.async=false;g.dataType="json";AppConnector.request(g).done(function(e){if(e.result.success==false){var i={text:e.result.message,sticker:false,sticker_hover:false,type:"error"};Vtiger_Helper_Js.showPnotify(i);send=false}else{send=true;b.submit()}},function(i,e){send=false});if(send==false){return false}})},generatePassword:function(k){var h=jQuery(k.currentTarget);var c=h.closest("form");var f=parseInt(jQuery("#minChars").val());var l=parseInt(jQuery("#maxChars").val());var j=jQuery("#allowedLetters").val();var m="";if(typeof(j)==="undefined"){j="!"}var b=j.split(",");if(typeof(f)==="undefined"){f=10}if(typeof(l)==="undefined"){l=15}var n=parseInt(Math.random()*(l-f)+f);var g=0;for(g=0;g<=n;g++){var a=parseInt(Math.random()*b.length);m+=b[a]}var d=c.find('[name ="password"]');d.val(m);d.trigger("change")},registerButtonsEvents:function(){var a=this;$(".generatePass").click(function(b){a.generatePassword(b)})},registerBasicEvents:function(a){this._super(a);this.registerButtonsEvents();this.registerRecordPreSaveEvent(a)}});
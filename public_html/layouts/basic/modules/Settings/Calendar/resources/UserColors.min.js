
var Settings_UserColors_Js={initEvants:function(){$(".UserColors .updateColor").click(Settings_UserColors_Js.updateColor);$(".UserColors #update_event").click(Settings_UserColors_Js.updateEvent);$(".UserColors .generateColor").click(Settings_UserColors_Js.generateColor)},generateColor:function(c){var b=$(c.currentTarget);var a=b.closest("tr");var d={id:a.data("id"),table:a.data("table"),field:a.data("field"),};app.saveAjax("generateColor",d).then(function(e){Settings_Vtiger_Index_Js.showMessage({type:"success",text:e.result.message});a.find(".calendarColor").css("background",e.result.color);a.data("color",e.result.color)})},updateColor:function(h){var g=$(h.currentTarget);var c=g.closest("tr");var a=jQuery(".UserColors .editColorContainer");var b=a.clone(true,true);var f=g.data("metod");var d=function(e){e.find(".editColorContainer").removeClass("hide").show();var j=e.find(".selectedColor");j.val(c.data("color"));var i={flat:true,color:c.data("color"),onChange:function(k,m,l){j.val("#"+m)}};if(typeof customParams!="undefined"){i=jQuery.extend(i,customParams)}e.find(".calendarColorPicker").ColorPicker(i);e.find('[name="saveButton"]').click(function(l){var k=$.progressIndicator({message:app.vtranslate("Update labels"),blockInfo:{enabled:true}});Settings_UserColors_Js.registerSaveEvent(f,{color:j.val(),id:c.data("id"),table:c.data("table"),field:c.data("field"),});c.find(".calendarColor").css("background",j.val());c.data("color",j.val());k.progressIndicator({mode:"hide"})})};app.showModalWindow(b,function(e){if(typeof d=="function"){d(e)}},{width:"1000px"})},updateEvent:function(d){var a=$.progressIndicator({message:app.vtranslate("Update labels"),blockInfo:{enabled:true}});var c=$(d.currentTarget);var b=c.data("metod");if(c.prop("checked")){value=1}else{value=0}params={};params.color=value;params.id=c.attr("id");params=jQuery.extend({},params);Settings_UserColors_Js.registerSaveEvent(b,params);a.progressIndicator({mode:"hide"})},registerSaveEvent:function(c,a){var b={};b.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:c,params:a};b.async=false;b.dataType="json";AppConnector.request(b).done(function(e){var d=e.result;var f={text:d.message,animation:"show",type:"success"};app.hideModalWindow();Vtiger_Helper_Js.showPnotify(f);return d},function(e,d){})},registerSaveWorkingDays:function(b){var a=this;b.find(".workignDaysField").change(function(d){var c=$(d.currentTarget);var f={};f.type=c.data("type");f.param=c.attr("name");if(c.attr("type")=="checkbox"){f.val=this.checked}else{f.val=c.val()}app.saveAjax("updateNotWorkingDays",f).then(function(e){Settings_Vtiger_Index_Js.showMessage({type:"success",text:e.result.message})})})},registerEvents:function(){Settings_UserColors_Js.initEvants();var a=$(".workingDaysTable");this.registerSaveWorkingDays(a)}};$(document).ready(function(){Settings_UserColors_Js.registerEvents()});
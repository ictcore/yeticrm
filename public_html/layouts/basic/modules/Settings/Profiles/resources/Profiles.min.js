
var Settings_Profiles_Js={initEditView:function(){function b(i){var h=jQuery(i.currentTarget);var f=jQuery('[data-togglecontent="'+h.data("togglehandler")+'"]');var g=f.closest("tr");if(h.find("i").hasClass("glyphicon-chevron-down")){g.removeClass("hide");f.slideDown("slow");h.find(".glyphicon-chevron-down").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up")}else{f.slideUp("slow",function(){g.addClass("hide")});h.find(".glyphicon-chevron-up").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")}}function a(i,g){var h=jQuery(g.handle);if(!h.hasClass("mini-slider-control")){h=h.closest(".mini-slider-control")}var f=jQuery('[data-range-input="'+h.data("range")+'"]');f.val(g.value);h.attr("data-value",g.value)}function e(i){var h=jQuery(i.currentTarget);var f=h.data("value");var g=h.closest("tr");if(h.prop("checked")){jQuery("[data-action-state]",g).prop("checked",true);jQuery("[data-handlerfor]",g).removeAttr("disabled")}else{jQuery("[data-action-state]",g).prop("checked",false);jQuery("[data-handlerfor]",g).attr("disabled","disabled");jQuery('[data-togglecontent="'+f+'-fields"]').hide();jQuery('[data-togglecontent="'+f+'-tools"]').hide()}}function d(i){var h=jQuery(i.currentTarget);var f=h.closest("tr");var g=h.prop("checked")?true:false;if(h.data("action-state")=="EditView"||h.data("action-state")=="Delete"){if(g){jQuery('[data-action-state="DetailView"]',f).prop("checked",true);jQuery("[data-module-state]",f).prop("checked",true);jQuery("[data-handlerfor]",f).removeAttr("disabled")}}if(h.data("action-state")=="DetailView"){if(!g){jQuery("[data-action-state]",f).prop("checked",false);jQuery("[data-module-state]",f).prop("checked",false).trigger("change")}else{jQuery("[data-module-state]",f).prop("checked",true);jQuery("[data-handlerfor]",f).removeAttr("disabled")}}}function c(h){var g=jQuery(h.currentTarget);var f=g.prop("checked")?true:false;if(f){jQuery("#mainAction4CheckBox").prop("checked",true);jQuery("#mainModulesCheckBox").prop("checked",true);jQuery(".modulesCheckBox").prop("checked",true);jQuery(".action4CheckBox").prop("checked",true);jQuery("[data-handlerfor]").removeAttr("disabled")}}jQuery("[data-module-state]").change(e);jQuery("[data-action-state]").change(d);jQuery("#mainAction1CheckBox,#mainAction2CheckBox, #mainAction7CheckBox").change(c);jQuery("[data-togglehandler]").click(b);jQuery("[data-range]").each(function(f,g){g=jQuery(g);var h=g.data("value");g.slider({min:0,max:2,value:h,disabled:g.data("locked"),slide:a})});jQuery("[data-range]").find("a").css("filter","")},registerSelectAllModulesEvent:function(){var b=jQuery(".modulesCheckBox");var e=jQuery("#mainAction4CheckBox");var f=jQuery("#mainAction1CheckBox");var a=jQuery("#mainAction2CheckBox");var c=jQuery("#mainAction7CheckBox");var d=jQuery("#mainModulesCheckBox");d.on("change",function(h){var g=jQuery(h.currentTarget);if(g.is(":checked")){b.prop("checked",true);e.prop("checked",true);f.show().prop("checked",true);a.show().prop("checked",true);c.show().prop("checked",true);b.trigger("change")}else{b.prop("checked",false);b.trigger("change");e.prop("checked",false);f.prop("checked",false);a.prop("checked",false);c.prop("checked",false)}});b.on("change",function(){Settings_Profiles_Js.checkSelectAll(b,d);Settings_Profiles_Js.checkSelectAll(jQuery(".action4CheckBox"),e);Settings_Profiles_Js.checkSelectAll(jQuery(".action1CheckBox"),f);Settings_Profiles_Js.checkSelectAll(jQuery(".action2CheckBox"),a);Settings_Profiles_Js.checkSelectAll(jQuery(".action7CheckBox"),c)})},registerSelectAllViewActionsEvent:function(){var a=jQuery(".action4CheckBox");var b=jQuery("#mainAction4CheckBox");var c=jQuery("#mainModulesCheckBox");b.on("change",function(f){var d=jQuery(f.currentTarget);if(d.is(":checked")){c.prop("checked",true);c.trigger("change")}else{c.prop("checked",false);c.trigger("change")}});a.on("change",function(){Settings_Profiles_Js.checkSelectAll(a,b)})},registerSelectAllEditActionsEvent:function(){var b=jQuery(".action1CheckBox");var a=jQuery("#mainAction1CheckBox");a.on("change",function(d){var c=jQuery(d.currentTarget);if(c.is(":checked")){b.prop("checked",true)}else{b.prop("checked",false)}});a.on("change",function(){Settings_Profiles_Js.checkSelectAll(b,a)})},registerSelectAllDeleteActionsEvent:function(){var a=jQuery(".action2CheckBox");var b=jQuery("#mainAction2CheckBox");b.on("change",function(d){var c=jQuery(d.currentTarget);if(c.is(":checked")){a.prop("checked",true)}else{a.prop("checked",false)}});a.on("change",function(){Settings_Profiles_Js.checkSelectAll(a,b)})},registerSelectAllCreateActionsEvent:function(){var b=jQuery(".action7CheckBox");var a=jQuery("#mainAction7CheckBox");a.on("change",function(d){var c=jQuery(d.currentTarget);if(c.is(":checked")){b.prop("checked",true)}else{b.prop("checked",false)}});b.on("change",function(){Settings_Profiles_Js.checkSelectAll(b,a)})},checkSelectAll:function(b,a){var c=true;if(typeof b=="undefined"||typeof a=="undefined"){return false}b.each(function(d,e){if(jQuery(e).is(":checked")){c=true}else{c=false;return false}});if(c==true){a.prop("checked",true)}else{a.prop("checked",false)}},performSelectAllActionsOnLoad:function(){if(jQuery("[data-module-unchecked]").length>0){jQuery("#mainModulesCheckBox").prop("checked",false)}if(jQuery("[data-action4-unchecked]").length<=0){jQuery("#mainAction4CheckBox").prop("checked",true)}if(jQuery("[data-action1-unchecked]").length<=0){jQuery("#mainAction1CheckBox").prop("checked",true)}if(jQuery("[data-action2-unchecked]").length>0){jQuery("#mainAction2CheckBox").prop("checked",false)}},registerSubmitEvent:function(){var b=this;var a=jQuery('[name="EditProfile"]');a.on("submit",function(f){var c=a.find('button[type="submit"]');c.attr("disabled",true);progressIndicatorInstance=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});if(a.data("submit")=="true"&&a.data("performCheck")=="true"){return true}else{if(a.data("jqv").InvalidFields.length<=0){var d=a.serializeFormData();b.checkDuplicateName({profileName:d.profilename,profileId:d.record}).then(function(e){a.data("submit","true");a.data("performCheck","true");a.submit()},function(g,e){progressIndicatorInstance.progressIndicator({mode:"hide"});c.attr("disabled",false);var h={};h.text=g.message;h.type="error";Settings_Vtiger_Index_Js.showMessage(h);return false})}else{progressIndicatorInstance.progressIndicator({mode:"hide"});c.attr("disabled",false);a.removeData("submit");app.formAlignmentAfterValidation(a)}f.preventDefault()}})},checkDuplicateName:function(c){var d=c.profileName;var b=c.profileId;var a=jQuery.Deferred();var e={module:app.getModuleName(),parent:app.getParentModuleName(),action:"EditAjax",mode:"checkDuplicate",profilename:d,record:b};AppConnector.request(e).then(function(h){var g=h.result;var f=g.success;if(f==true){a.reject(g)}else{a.resolve(g)}},function(f,g){a.reject()});return a.promise()},registerGlobalPermissionActionsEvent:function(){var a=jQuery('[name="editall"]').filter(":checkbox");var b=jQuery('[name="viewall"]').filter(":checkbox");if(a.is(":checked")){b.attr("readonly","readonly")}b.on("change",function(f){var d=jQuery(f.currentTarget);if(d.attr("readonly")=="readonly"){var c=jQuery(f.currentTarget).is(":checked");if(!c){jQuery(f.currentTarget).prop("checked",true)}else{jQuery(f.currentTarget).prop("checked",false)}f.preventDefault()}});a.on("change",function(d){var c=jQuery(d.currentTarget);if(c.is(":checked")){b.prop("checked","checked");b.attr("readonly","readonly")}else{b.removeAttr("readonly")}})},registerEvents:function(){Settings_Profiles_Js.initEditView();Settings_Profiles_Js.registerSelectAllModulesEvent();Settings_Profiles_Js.registerSelectAllViewActionsEvent();Settings_Profiles_Js.registerSelectAllCreateActionsEvent();Settings_Profiles_Js.registerSelectAllEditActionsEvent();Settings_Profiles_Js.registerSelectAllDeleteActionsEvent();Settings_Profiles_Js.performSelectAllActionsOnLoad();Settings_Profiles_Js.registerSubmitEvent();Settings_Profiles_Js.registerGlobalPermissionActionsEvent()}};jQuery(document).ready(function(){Settings_Profiles_Js.registerEvents()});
jQuery.Class("Settings_MarketingProcesses_Index_Js",{},{registerChangeVal:function(b){var a=this;b.find(".configField").change(function(d){var c=$(d.currentTarget);var f={};f.type=c.data("type");f.param=c.attr("name");if(c.attr("type")=="checkbox"){f.val=this.checked}else{f.val=c.val()!=null?c.val():""}app.saveAjax("updateConfig",f).then(function(e){Settings_Vtiger_Index_Js.showMessage({type:"success",text:e.result.message})})})},registerSaveMapping:function(b){var a=this;b.find("button.saveMapping").on("click",function(){var c=[];jQuery("#convertLeadMapping tr.listViewEntries:not(.hide)").each(function(){var d=jQuery(this).find("select.leadsFields").val();var f=jQuery(this).find("select.accountsFields").val();var e=[];e[d]=f;e=jQuery.extend({},e);if(a.uniqueReduce(c,e)){c.push(e)}});if(c.length){jQuery('[name="mapping"]').val(JSON.stringify(c)).change()}else{Settings_Vtiger_Index_Js.showMessage({type:"info",text:app.vtranslate("JS_NO_CONDITIONS")})}})},uniqueReduce:function(b,a){for(var c in b){if(JSON.stringify(b[c])===JSON.stringify(a)){return false}}return true},registerEventToDeleteMapping:function(b){var a=this;b.find(".deleteMapping").on("click",function(f){var c=jQuery(f.currentTarget);var d=c.closest("tr");d.remove()})},registerMapping:function(b){var a=this;b.find('[name="create_always"]').on("change",function(d){var c=jQuery(".mappingTable");if(this.checked){c.removeClass("hide")}else{c.addClass("hide")}})},registerEvents:function(){var b=$("#supportProcessesContainer");this.registerChangeVal(b);this.registerSaveMapping(b);this.registerMapping(b);this.registerEventToDeleteMapping(b);var a=new Settings_LeadMapping_Js();a.registerEventForAddingNewMapping()}});
Settings_PDF_Edit_Js("Settings_PDF_Edit8_Js",{},{step8Container:false,advanceFilterInstance:false,ckEditorInstance:false,fieldValueMap:false,init:function(){this.initialize()},getContainer:function(){return this.step8Container},setContainer:function(a){this.step8Container=a;return this},initialize:function(a){if(typeof a==="undefined"){a=jQuery("#pdf_step8")}if(a.is("#pdf_step8")){this.setContainer(a)}else{this.setContainer(jQuery("#pdf_step8"))}},submit:function(){var b=jQuery.Deferred();var c=this.getContainer();var d=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var a=c.serializeFormData();a.action="Save";a.step=8;AppConnector.request(a).then(function(e){if(e.success==true){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate("JS_PDF_SAVED_SUCCESSFULLY")});setTimeout(function(){window.location.href="index.php?module=PDF&parent=Settings&page=1&view=List";d.progressIndicator({mode:"hide"})},1000)}},function(e,f){app.errorLog(e,f)});return b.promise()},registerCancelStepClickEvent:function(a){jQuery("button.cancelLink",a).on("click",function(){window.history.back()})},registerWatermarkTypeChange:function(a){var b=a.find("#watermark_type");b.on("change",function(){a.find(".watertext").toggleClass("hide");a.find(".waterimage").toggleClass("hide")})},registerUploadButton:function(a){a.find("#uploadWM").on("click",function(h){h.preventDefault();var b=a.find("#watermark_image");var f=b[0].files;var g=new FormData();for(var d=0;d<f.length;d++){var c=f[d];if(!c.type.match("image.*")){continue}g.append("watermark[]",c,c.name)}g.append("template_id",a.find('[name="record"]').val());var j=new XMLHttpRequest();j.open("POST","index.php?module=PDF&parent=Settings&action=Watermark&mode=Upload",true);j.onload=function(){if(j.status===200){var k=a.find('[name="record"]').val();var l=f[0]["name"];var i=l.split(".");var e=k+"."+i[i.length-1];a.find("#watermark").html('<img src="storage/Pdf/watermark/'+e+'" class="col-md-9" />');a.find('[name="watermark_image"]').val("storage/Pdf/watermark/"+e);a.find("#deleteWM").removeClass("hide")}};j.send(g)})},registerDeleteUploadButton:function(a){a.find("#deleteWM").on("click",function(b){b.preventDefault();var c={};c.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"Watermark",mode:"Delete",id:a.find('[name="record"]').val()};c.dataType="json";AppConnector.request(c).then(function(e){var d=e.result;if(d){a.find("#watermark").html("");a.find('[name="watermark_image"]').val("");a.find("#deleteWM").addClass("hide")}},function(e,d){app.errorLog(e,d)})})},registerEvents:function(){var a=this.getContainer();app.changeSelectElementView(a);this.registerCancelStepClickEvent(a);this.registerWatermarkTypeChange(a);this.registerUploadButton(a);this.registerDeleteUploadButton(a)}});

Vtiger_List_Js("Portal_List_Js",{getDefaultParams:function(){var a={module:app.getModuleName(),view:"List",page:jQuery("#pageNumber").val(),orderby:jQuery("#orderBy").val(),sortorder:jQuery("#sortOrder").val(),search_value:jQuery("#alphabetValue").val()};return a},editBookmark:function(a){AppConnector.request(a).then(function(c){var b=function(d){Portal_List_Js.saveBookmark()};app.showModalWindow(c,function(d){if(typeof b=="function"){b(d)}})})},saveBookmark:function(){jQuery("#saveBookmark").on("submit",function(c){c.preventDefault();var a=jQuery(c.currentTarget);var d=a.serializeFormData();if(d.bookmarkName==""||d.bookmarkUrl==""){var b={title:app.vtranslate("JS_MESSAGE"),text:app.vtranslate("JS_ENTER_MANDATORY_FIELD"),animation:"show",type:"error"};Vtiger_Helper_Js.showPnotify(b);return false}AppConnector.request(d).then(function(f){if(f.success){var g={title:app.vtranslate("JS_MESSAGE"),text:f.result.message,animation:"show",type:"success"};Vtiger_Helper_Js.showPnotify(g);var e=Portal_List_Js.getDefaultParams();Portal_List_Js.loadListViewContent(e);app.hideModalWindow()}})})},massDeleteRecords:function(){var d=Vtiger_List_Js.getInstance();var b=d.checkListRecordSelected();if(b!=true){var a=d.readSelectedIds(true);var e=d.readExcludedIds(true);var c=app.vtranslate("LBL_MASS_DELETE_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:c}).then(function(h){var g="index.php?module="+app.getModuleName()+"&action=MassDelete";g+="&selected_ids="+a+"&excluded_ids="+e;var f=d.getAlphabetSearchValue();if((typeof f!="undefined")&&(f.length>0)){g+="&search_value="+f}AppConnector.request(g).then(function(j){if(j.success){var k={title:app.vtranslate("JS_MESSAGE"),text:j.result.message,animation:"show",type:"error"};Vtiger_Helper_Js.showPnotify(k);var i=Portal_List_Js.getDefaultParams();Portal_List_Js.loadListViewContent(i)}})})}else{d.noRecordSelectedAlert()}},loadListViewContent:function(a){var b=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.requestPjax(a).then(function(c){b.progressIndicator({mode:"hide"});jQuery("#listViewContents").html(c);Portal_List_Js.updatePagination()})},updatePagination:function(){var d=jQuery("#previousPageExist").val();var k=jQuery("#nextPageExist").val();var h=jQuery("#previousPageButton");var f=jQuery("#nextPageButton");var g=parseInt(jQuery("#noOfEntries").val());var a=parseInt(jQuery("#pageStartRange").val());var i=parseInt(jQuery("#pageEndRange").val());var c=jQuery("#totalPageCount").text();var b=jQuery(".totalNumberOfRecords");var j=jQuery(".pageNumbersText");var e=parseInt(jQuery("#pageNumber").val());jQuery("#pageToJump").val(e);if(d!=""){h.removeAttr("disabled")}else{if(d==""){h.attr("disabled","disabled")}}if((k!="")&&(c>1)){f.removeAttr("disabled")}else{if((k=="")||(c==1)){f.attr("disabled","disabled")}}if(g!=0){var l=a+" ("+i+")";j.html(l);b.removeClass("hide")}else{j.html("<span>&nbsp;</span>");if(!b.hasClass("hide")){b.addClass("hide")}}}},{registerAddBookmark:function(){jQuery(".addBookmark").on("click",function(){var a={module:app.getModuleName(),parent:app.getParentModuleName(),view:"EditAjax"};Portal_List_Js.editBookmark(a)})},registerEditBookmark:function(){jQuery(".editRecord").live("click",function(b){b.stopPropagation();var a=jQuery(b.currentTarget);var d=a.closest(".listViewEntries").data("id");var c={module:app.getModuleName(),parent:app.getParentModuleName(),view:"EditAjax",record:d};Portal_List_Js.editBookmark(c)})},registerDeleteBookmark:function(){jQuery(".deleteRecord").live("click",function(c){c.stopPropagation();c.preventDefault();var b=jQuery(c.currentTarget);var d=b.closest(".listViewEntries").data("id");var a=app.vtranslate("LBL_DELETE_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:a}).then(function(f){var g={module:app.getModuleName(),parent:app.getParentModuleName(),action:"DeleteAjax",record:d};AppConnector.request(g).then(function(h){if(h.success){var i={title:app.vtranslate("JS_MESSAGE"),text:h.result.message,animation:"show",type:"error"};Vtiger_Helper_Js.showPnotify(i);var e=Portal_List_Js.getDefaultParams();Portal_List_Js.loadListViewContent(e)}})})})},registerAlphabetSearch:function(){jQuery(".portalAlphabetSearch").live("click",function(d){var c=jQuery(d.currentTarget);var b=c.find("a").attr("id");var a=Portal_List_Js.getDefaultParams();a.search_value=b;Portal_List_Js.loadListViewContent(a)})},registerSortingEvent:function(){jQuery(".portalListViewHeader").live("click",function(d){var c=jQuery(d.currentTarget);var f=c.attr("id");var b=c.data("nextsortorderval");var a=Portal_List_Js.getDefaultParams();a.orderby=f;a.sortorder=b;Portal_List_Js.loadListViewContent(a)})},registerPreviousPageEvent:function(){jQuery("#previousPageButton").on("click",function(d){var c=jQuery("#pageNumber").val();var a=parseInt(c)-1;if(a<1){return false}var b=Portal_List_Js.getDefaultParams();b.page=a;Portal_List_Js.loadListViewContent(b)})},registerNextPageEvent:function(){jQuery("#nextPageButton").on("click",function(f){var c=jQuery("#pageNumber").val();var a=parseInt(c)+1;var d=parseInt(jQuery("#totalPageCount").text());if(a>d){return false}var b=Portal_List_Js.getDefaultParams();b.page=a;Portal_List_Js.loadListViewContent(b)})},registerRowClickEvent:function(){jQuery(".listViewEntries").live("click",function(b){if(jQuery(b.target,jQuery(b.currentTarget)).is("td:first-child")){return}if(jQuery(b.target).is('input[type="checkbox"]')){return}var a=jQuery(b.currentTarget);var c=a.data("recordurl");if(typeof c=="undefined"){return}window.location.href=c})},registerEvents:function(){this._super();this.registerAddBookmark();this.registerEditBookmark();this.registerDeleteBookmark();this.registerAlphabetSearch();this.registerSortingEvent();this.registerPreviousPageEvent();this.registerNextPageEvent();this.registerRowClickEvent()}});

jQuery.Class("Vtiger_BasicSearch_Js",{},{searchModule:false,currentSearchModule:false,reduceNumberResults:false,returnHtml:true,mainConatiner:false,getSearchModule:function(){if(this.searchModule===false){var a=app.getModuleName();if(typeof this.getCurrentSearchModule()!="undefined"){a=this.getCurrentSearchModule()}this.setSearchModule(a)}return this.searchModule},setSearchModule:function(a){this.searchModule=a;return this},setMainContainer:function(a){this.mainConatiner=a;return this},getCurrentSearchModule:function(){if(this.currentSearchModule===false&&this.mainConatiner){this.currentSearchModule=this.mainConatiner.find(".basicSearchModulesList").val()}return this.currentSearchModule},_search:function(b){var a=jQuery.Deferred();if(typeof b=="undefined"){b={}}b.view="BasicAjax";b.mode="showSearchResults";b.limit=this.reduceNumberResults;b.html=this.returnHtml;if(this.mainConatiner.find("input[data-operator]").length&&this.mainConatiner.find("input[data-operator]").data("operator")!=""){b.operator=this.mainConatiner.find("input[data-operator]").data("operator")}if(typeof b.module=="undefined"){b.module=app.getModuleName();if(app.getParentModuleName().length>0){b.module="Vtiger"}}AppConnector.request(b).then(function(c){a.resolve(c)},function(c,d){a.reject(c)});return a.promise()},search:function(b){var a=this.getCurrentSearchModule();var c={};c.value=b;if(typeof a!="undefined"){c.searchModule=a}c.curentModule=app.getModuleName();return this._search(c)},showSearchResults:function(c){var b=jQuery.Deferred();var a=function(f){var e=jQuery(f).find(".contents");b.resolve(f)};var d={};d.data=c;d.cb=a;app.showModalWindow(d);return b.promise()}});
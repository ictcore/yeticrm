
Vtiger_RelatedList_Js("Campaigns_RelatedList_Js",{triggerSendEmail:function(){Vtiger_List_Js.triggerSendEmail({relatedLoad:true,sourceModule:app.getModuleName(),sourceRecord:app.getRecordId(),module:jQuery(".relatedModuleName").val(),cvid:jQuery("#recordsFilter").val(),})}},{loadRelatedList:function(c){var a=jQuery.Deferred();var b=this;this._super(c).then(function(g){b.registerEvents();var d=app.getModuleName();var e=d+"_List_Js";var f=new window[e]();f.registerEvents();a.resolve(g)});return a.promise()},getCompleteParams:function(){var b={};b.view="Detail";b.module=this.parentModuleName;b.record=this.getParentId();b.relatedModule=this.relatedModulename;b.sortorder=this.getSortOrder();b.orderby=this.getOrderBy();b.page=this.getCurrentPageNum();b.mode="showRelatedList";b.selectedIds=jQuery("#selectedIds").data("selectedIds");b.excludedIds=jQuery("#excludedIds").data("excludedIds");if(this.listSearchInstance){var a=this.listSearchInstance.getAlphabetSearchValue();b.search_params=JSON.stringify(this.listSearchInstance.getListSearchParams())}if((typeof a!="undefined")&&(a.length>0)){b.search_key=this.listSearchInstance.getAlphabetSearchField();b.search_value=a;b.operator="s"}return b},changeCustomFilterElementView:function(){var a=jQuery("#recordsFilter");if(a.length>0){app.showSelect2ElementView(a,{templateSelection:function(d){var c=jQuery("<span></span>");c.append(jQuery(jQuery(".filterImage").detach().get(0)).show());c.append(d.text);return c},customSortOptGroup:true,closeOnSelect:true});var b=a.data("select2");b.$dropdown.append(jQuery("span.filterActionsDiv"))}},registerChangeCustomFilterEvent:function(){var d=this;var a=d.getRelatedContainer();var c=a.find(".loadFormFilterButton");var b=a.find("#recordsFilter");c.click(function(g){var f=app.vtranslate("JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_ADD_THIS_FILTER");Vtiger_Helper_Js.showConfirmationBox({message:f}).then(function(){var e=b.val();var j=a.find(".relatedModuleName").val();var i={sourceRecord:app.getRecordId(),relatedModule:j,viewId:e,module:app.getModuleName(),action:"RelationAjax",mode:"addRelationsFromRelatedModuleViewId"};var h=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(i).then(function(k){h.progressIndicator({mode:"hide"});if(k!=null){var l=app.vtranslate("JS_NO_RECORDS_RELATED_TO_THIS_FILTER");var m={text:l,type:"info"};Vtiger_Helper_Js.showMessage(m)}else{Vtiger_Detail_Js.reloadRelatedList()}},function(l,k){})},function(e,h){})})},registerEventToEditRelatedStatus:function(){var b=this;jQuery(".currentStatus").on("click",function(d){d.stopImmediatePropagation();var c=jQuery(d.currentTarget);c.addClass("open")});var a=jQuery(".currentStatus").find(".dropdown-menu");a.on("click","a",function(j){j.stopImmediatePropagation();var g=jQuery(j.currentTarget);var h=g.closest("li");var f=g.closest(".currentStatus");var d=h.attr("id");var c=h.data("status");var i=g.closest("tr").data("id");var k={relatedModule:b.relatedModulename,relatedRecord:i,status:d,module:app.getModuleName(),action:"RelationAjax",sourceRecord:b.parentRecordId,mode:"updateStatus"};g.progressIndicator({});AppConnector.request(k).then(function(e){if(e.result[0]){g.progressIndicator({mode:"hide"});f.find(".statusValue").text(c);f.removeClass("open")}},function(l,e){})})},registerEvents:function(){this.changeCustomFilterElementView();this.registerChangeCustomFilterEvent();this.registerEventToEditRelatedStatus()}});
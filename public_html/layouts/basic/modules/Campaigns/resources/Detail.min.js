
Vtiger_Detail_Js("Campaigns_Detail_Js",{},{loadRelatedList:function(c){var a=jQuery.Deferred();if(c==undefined){c={}}var b=new Campaigns_RelatedList_Js(this.getRecordId(),app.getModuleName(),this.getSelectedTab(),this.getRelatedModuleName());this.clearSelectedRecords();b.loadRelatedList(c).then(function(d){a.resolve(d)},function(e,d){a.reject(e,d)});return a.promise()},clearSelectedRecords:function(){jQuery('[name="selectedIds"]').data("selectedIds","");jQuery('[name="excludedIds"]').data("excludedIds","")},registerEventForRelatedListPagination:function(){var b=this;var a=this.getContentHolder();a.on("click","#relatedViewNextPageButton",function(g){var d=jQuery(g.currentTarget);if(d.hasClass("disabled")){return}var c=b.getSelectedTab();var h=b.getRelatedModuleName();var f=new Campaigns_RelatedList_Js(b.getRecordId(),app.getModuleName(),c,h);f.nextPageHandler().then(function(i){var e=jQuery(i).find('[name="emailEnabledModules"]').val();if(e){b.registerEmailEnabledActions()}})});a.on("click","#relatedViewPreviousPageButton",function(){var c=b.getSelectedTab();var e=b.getRelatedModuleName();var d=new Campaigns_RelatedList_Js(b.getRecordId(),app.getModuleName(),c,e);d.previousPageHandler().then(function(g){var f=jQuery(g).find('[name="emailEnabledModules"]').val();if(f){b.registerEmailEnabledActions()}})});a.on("click","#relatedListPageJump",function(f){var c=b.getSelectedTab();var g=b.getRelatedModuleName();var d=new Campaigns_RelatedList_Js(b.getRecordId(),app.getModuleName(),c,g);d.getRelatedPageCount()});a.on("click","#relatedListPageJumpDropDown > li",function(c){c.stopImmediatePropagation()}).on("keypress","#pageToJump",function(f){var c=b.getSelectedTab();var g=b.getRelatedModuleName();var d=new Campaigns_RelatedList_Js(b.getRecordId(),app.getModuleName(),c,g);d.pageJumpHandler(f).then(function(h){var e=jQuery(h).find('[name="emailEnabledModules"]').val();if(e){b.registerEmailEnabledActions()}})})},registerEventForRelatedList:function(){var c=this;var b=this.getContentHolder();c.registerEventForAddingRelatedRecord(b);b.on("click",".relatedListHeaderValues",function(i){var g=jQuery(i.currentTarget);var f=c.getSelectedTab();var j=c.getRelatedModuleName();var h=new Campaigns_RelatedList_Js(c.getRecordId(),app.getModuleName(),f,j);h.sortHandler(g).then(function(l){var k=jQuery(l).find('[name="emailEnabledModules"]').val();if(k){c.registerEmailEnabledActions()}})});b.on("click","button.selectRelation",function(h){var f=c.getSelectedTab();var i=c.getRelatedModuleName();var g=new Campaigns_RelatedList_Js(c.getRecordId(),app.getModuleName(),f,i);g.showSelectRelationPopup().then(function(k){var j=jQuery(k).find('[name="emailEnabledModules"]').val();if(j){c.registerEmailEnabledActions()}})});b.on("click","a.relationDelete",function(j){j.stopImmediatePropagation();var h=jQuery(j.currentTarget);var f=Vtiger_Detail_Js.getInstance();var g=f.getDeleteMessageKey();var i=app.vtranslate(g);Vtiger_Helper_Js.showConfirmationBox({message:i}).then(function(n){var p=h.closest("tr");var l=p.data("id");var k=c.getSelectedTab();var o=c.getRelatedModuleName();var m=new Campaigns_RelatedList_Js(c.getRecordId(),app.getModuleName(),k,o);m.deleteRelation([l]).then(function(q){var s=h.closest(".widgetContentBlock");if(s.length){c.loadWidget(s);var r=b.find("[data-type='Updates']");if(r.length>0){c.loadWidget(r)}}else{m.loadRelatedList().then(function(w){var u=jQuery(w).find('[name="emailEnabledModules"]').val();if(jQuery("#selectedIds").length){var v=Vtiger_List_Js.getInstance();var t=v.readSelectedIds();if(t!="all"){l=l.toString();var x=jQuery.inArray(l,t);if(x!=-1){t.splice(x,1);v.writeSelectedIds(t)}}}if(u){c.registerEmailEnabledActions()}})}})},function(k,l){})});b.on("click","a.favorites",function(l){var g=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var i=jQuery(l.currentTarget);var n=Vtiger_Detail_Js.getInstance();var o=i.closest("tr");var k=o.data("id");var h=i.closest(".widget_contents");var j=c.getSelectedTab();var m=c.getRelatedModuleName();if(m==undefined){m=h.find(".relatedModuleName").val()}var f=new Vtiger_RelatedList_Js(c.getRecordId(),app.getModuleName(),j,m);f.favoritesRelation(k,i.data("state")).then(function(p){if(p){var q=i.data("state")?0:1;i.data("state",q);i.find(".glyphicon").each(function(){if(jQuery(this).hasClass("hide")){jQuery(this).removeClass("hide")}else{jQuery(this).addClass("hide")}});g.progressIndicator({mode:"hide"});var r=app.vtranslate("JS_REMOVED_FROM_FAVORITES");if(q){r=app.vtranslate("JS_ADDED_TO_FAVORITES")}Vtiger_Helper_Js.showPnotify({text:r,type:"success",animation:"show"})}})});b.on("click",".relatedContents .listViewEntries td",function(g){var f=jQuery(g.target);var h=f.closest("tr");var i=h.next();if(i.hasClass("listViewInventoryEntries")&&!f.closest("div").hasClass("actions")&&!f.is("a")&&!f.is("input")){i.toggleClass("hide")}});var a=c.getSelectedTab();var e=c.getRelatedModuleName();var d=new Vtiger_RelatedList_Js(c.getRecordId(),app.getModuleName(),a,e);d.registerUnreviewedCountEvent()},registerEventForAddingRelatedRecord:function(){var b=this;var a=this.getContentHolder();a.on("click",'[name="addButton"]',function(g){var d=jQuery(g.currentTarget);var c=b.getSelectedTab();var h=b.getRelatedModuleName();if(d.hasClass("quickCreateSupported")!=true){window.location.href=d.data("url");return}var f=new Campaigns_RelatedList_Js(b.getRecordId(),app.getModuleName(),c,h);f.addRelatedRecord(d).then(function(i){var e=jQuery(i).find('[name="emailEnabledModules"]').val();if(e){b.registerEmailEnabledActions()}f.registerEvents()})})},registerEmailEnabledActions:function(){var a=app.getModuleName();var b=a+"_List_Js";var c=new window[b]();c.registerEvents();c.markSelectedRecords()},registerEventForRelatedTabClick:function(){var c=this;var b=c.getContentHolder();var a=b.closest("div.detailViewInfo");jQuery(".related",a).on("click","li",function(j,i){var g=jQuery(j.currentTarget);if(!g.hasClass("dropdown")){var f=jQuery("<div></div>");f.progressIndicator({position:"html",blockInfo:{enabled:true,elementToBlock:a}});var d=g.data("url");if(typeof i!="undefined"){var h=i.callback;delete i.callback}c.loadContents(d,i).then(function(l){c.deSelectAllrelatedTabs();c.markTabAsSelected(g);app.showBtnSwitch(b.find(".switchBtn"));Vtiger_Helper_Js.showHorizontalTopScrollBar();c.registerHelpInfo();app.registerModal(b);app.registerMoreContent(b.find("button.moreBtn"));f.progressIndicator({mode:"hide"});var e=jQuery(l).find('[name="emailEnabledModules"]').val();if(e){var k=new Campaigns_List_Js();k.registerEvents();c.registerRelatedListEvents()}if(typeof h=="function"){h(l)}if(g.data("linkKey")==c.detailViewSummaryTabLabel){c.loadWidgets()}c.registerBasicEvents()},function(){f.progressIndicator({mode:"hide"})})}})},registerRelatedListEvents:function(){var a=this.getSelectedTab();var c=this.getRelatedModuleName();var b=new Campaigns_RelatedList_Js(this.getRecordId(),app.getModuleName(),a,c);b.registerEvents()},registerEvents:function(){this._super();this.registerRelatedListEvents();var a=Vtiger_List_Js.getInstance();a.registerEvents()}});

(function(a){if(typeof define==="function"&&define.amd){define("jstree.edit",["jquery","jstree"],a)}else{if(typeof exports==="object"){a(require("jquery"),require("jstree"))}else{a(jQuery,jQuery.jstree)}}}(function(c,a,d){if(c.jstree.plugins.edit){return}c.jstree.defaults.edit={createClass:" glyphicon-plus-sign",deleteClass:" glyphicon-remove-circle"};var b=document.createElement("I");b.className="jstree-edit glyphicon noAction";b.setAttribute("role","presentation");c.jstree.plugins.edit=function(e,f){this.bind=function(){f.bind.call(this);this.element.on("select_node.jstree",c.proxy(function(l,k){var j=c(k.event.currentTarget).closest("#treePopupContainer");var i=j.find("#relatedModule").val();if(k.event.target.className.indexOf("jstree-edit")!==-1){var l=k.node;if(l.original.type=="category"){app.hideModalWindow();var h=function(){c('.showModal[data-module="OutsourcedProducts"]').trigger("click");Vtiger_Detail_Js.getInstance().loadWidgets()};var g={callbackFunction:h,data:{productname:l.original.text,parent_id:app.getRecordId(),pscategory:l.original.record_id},noCache:true};Vtiger_Header_Js.getInstance().quickCreateModule(i,g)}else{app.hideModalWindow();Vtiger_Helper_Js.showConfirmationBox({message:app.vtranslate("JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE")}).then(function(m){AppConnector.request({module:i,action:"DeleteAjax",record:l.original.record_id}).then(function(n){c('.showModal[data-module="OutsourcedProducts"]').trigger("click");Vtiger_Detail_Js.getInstance().loadWidgets()})},function(){c('.showModal[data-module="OutsourcedProducts"]').trigger("click")})}}},this))};this.redraw_node=function(p,g,m,o){p=f.redraw_node.apply(this,arguments);if(p){var l,h,k=null,n=null;for(l=0,h=p.childNodes.length;l<h;l++){if(p.childNodes[l]&&p.childNodes[l].className&&p.childNodes[l].className.indexOf("jstree-anchor")!==-1){k=p.childNodes[l];break}}if(k&&this._model.data[p.id].original.type!==d){n=b.cloneNode(false);if(this._model.data[p.id].original.type=="category"){n.className+=e.createClass}else{n.className+=e.deleteClass}k.appendChild(n,k.childNodes[0])}}return p}}}));